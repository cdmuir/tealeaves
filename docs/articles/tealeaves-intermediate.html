<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tealeaves: Intermediate Users • tealeaves</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tealeaves: Intermediate Users">
<meta property="og:description" content="tealeaves">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tealeaves</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/parameter-functions.html">Defining parameters as functions of other parameters</a>
    </li>
    <li>
      <a href="../articles/tealeaves-intermediate.html">tealeaves: Intermediate Users</a>
    </li>
    <li>
      <a href="../articles/tealeaves-introduction.html">Introduction to the tealeaves package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tealeaves: Intermediate Users</h1>
                        <h4 class="author">Chris Mur</h4>
            
            <h4 class="date">2020-06-12</h4>
      
      
      <div class="hidden name"><code>tealeaves-intermediate.Rmd</code></div>

    </div>

    
    
<p>In this more advanced example, we’ll model leaf temperature across a gradient of air temperatures from 0 to 40 °C for leaves under low and high light conditions. We’ll also look at differences between hypostomatous and amphistomatous leaves. We use the  argument to save time<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, but it still takes a couple minutes. I’ve saved the output as example data called .</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">
<span class="co"># install tidyverse packages if necessary</span>
<span class="co"># install.packages("tidyverse")</span>

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tealeaves</span>)

<span class="co"># Parameter sets ----</span>

<span class="no">cs</span> <span class="kw">&lt;-</span> <span class="kw pkg">tealeaves</span><span class="kw ns">::</span><span class="fu"><a href="../reference/make_parameters.html">make_constants</a></span>()
<span class="no">lp</span> <span class="kw">&lt;-</span> <span class="kw pkg">tealeaves</span><span class="kw ns">::</span><span class="fu"><a href="../reference/make_parameters.html">make_leafpar</a></span>(
  <span class="kw">replace</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="co"># Hypo- and amphistomatous leaves</span>
    <span class="kw">logit_sr</span> <span class="kw">=</span> <span class="fu">set_units</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">Inf</span>, <span class="fl">0</span>))
  )
)
<span class="no">ep</span> <span class="kw">&lt;-</span> <span class="kw pkg">tealeaves</span><span class="kw ns">::</span><span class="fu"><a href="../reference/make_parameters.html">make_enviropar</a></span>(
  <span class="kw">replace</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="co"># Low and high light</span>
    <span class="kw">S_sw</span> <span class="kw">=</span> <span class="fu">set_units</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">220</span>, <span class="fl">660</span>), <span class="st">"W/m^2"</span>),
    <span class="co"># Air temperature gradient</span>
    <span class="kw">T_air</span> <span class="kw">=</span> <span class="fu">set_units</span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">278.15</span>, <span class="fl">313.15</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">25</span>), <span class="st">"K"</span>)
    )
)

<span class="co"># Run tleaves ----</span>
<span class="no">tl_example1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/tleaves.html">tleaves</a></span>(<span class="no">lp</span>, <span class="no">ep</span>, <span class="no">cs</span>)

<span class="kw pkg">usethis</span><span class="kw ns">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html">use_data</a></span>(<span class="no">tl_example1</span>)</pre></body></html></div>
<p>Next, we’ll usee <strong>ggplot2</strong> to plot the leaf-to-air temperature difference as function of air temperature at the two light levels.</p>
<p><img src="tealeaves-intermediate_files/figure-html/plot%20temperature-1.png" width="672"></p>
<p>The results show that leaves are warmer than the atmosphere at cool temperatures and cooler at high temperatures. In sunnier conditions, leaves are warmer. Finally, amphistomatous leaves are somewhat cooler because they evaporate more water. To see this, let’s look directly at transpiration in the same data:</p>
<p><img src="tealeaves-intermediate_files/figure-html/plot%20transpiration-1.png" width="672"></p>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The ’unit’ed version ensures that all calculations start and end with the proper units. The unitless functions <em>should</em> give the same answer because I run tests every time the package is updated, but it’s always good to double check for bugs.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Chris Muir.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
